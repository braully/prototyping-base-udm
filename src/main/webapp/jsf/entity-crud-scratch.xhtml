<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <ui:composition template="/autogen/template-base-app.xhtml">
        <ui:define name="template.app.title">entityDummy</ui:define>
        <ui:define name="template.body.append"></ui:define>
        <ui:define name="template.app.menu">
            <ui:include src="/jsf/template/menu-base-app.xhtml" />
        </ui:define>
        <ui:define name="template.head.append">
            <meta name="_csrf" content="${_csrf.token}"/>
            <meta name="_csrf_header" content="${_csrf.headerName}"/>
        </ui:define>

        <ui:define name="template.app.content">
            <h:messages infoClass="autogen-message-info" 
                        warnClass="autogen-message-warning"
                        fatalClass="autogen-message-error"
                        errorClass="autogen-message-error" 
                        showSummary="true" showDetail="true"  />
        </ui:define>

        <ui:define name="template.body.append">
            <form id="form-action" action="/app/action" class="hidden">
                <input type="hidden" name="action" />
                <input type="hidden" name="param" />
            </form>
            <!-- Modal -->
            <div class="modal fade" id="autogen-modal" 
                 tabindex="-1" role="dialog" 
                 aria-labelledby="autogen-modalLabel" 
                 aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" 
                                id="autogen-modalLabel">Modal title</h5>
                            <button type="button" class="close" 
                                    data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true"></span>
                            </button>
                        </div>
                        <div class="modal-body">
                            ...
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary"
                                    data-dismiss="modal">Close</button>
                            <button type="button" 
                                    class="btn btn-primary">Save</button>
                        </div>
                    </div>
                </div>
            </div> 
        </ui:define>

        <ui:define name="template.app.content.form">
            <h:outputText value="Entity-id: #{param['id']}" />

            <h:form>
                <div class="autogen-form-group">
                    <label class="autogen-form-group-label">Name</label>
                    <input class="autogen-form-group-input" 
                           jsfc="h:inputText" 
                           value="#{genericMB.crud('entityDummy').entity.name}" />
                </div>
                <div class="autogen-form-group">
                    <label>Code</label>
                    <input class="autogen-form-group-input" jsfc="h:inputText" 
                           value="#{genericMB.crud('entityDummy').entity.code}" />
                </div>

                <div class="autogen-form-group">
                    <label>Fraction</label>
                    <input class="autogen-form-group-input" jsfc="h:inputText" 
                           value="#{genericMB.crud('entityDummy').entity.fraction}" />
                </div>

                <div class="autogen-form-group-check">
                    <input type="checkbox" class="autogen-form-group-input-check" 
                           jsfc="h:selectBooleanCheckbox" 
                           value="#{genericMB.crud('entityDummy').entity.checked}"/>
                    <label class="autogen-form-group-label-check">Checked</label>
                </div>

                <div class="autogen-form-group">
                    <label>Status</label>
                    <select class="autogen-form-group-input" jsfc="h:selectOneMenu"
                            value="#{genericMB.crud('entityDummy').entity.statusType}">	
                        <f:selectItem itemLabel="" itemValue="" />
                        <f:selectItems value="#{genericMB.crud('entityDummy').values('entityDummy.statusType')}" 
                                       var="st" itemLabel="#{st.toString()}" itemValue="#{st}" />
                    </select>
                </div>

                <div class="autogen-form-group">
                    <input class="autogen-form-group-button-save"  jsfc="h:commandButton" 
                           value="Salvar" action="#{genericMB.crud('entityDummy').save()}">
                    </input>
                </div>
            </h:form>
        </ui:define>

        <ui:define name="template.app.content.filter">
            <hr />
            <h:form>
                <div class="autogen-filter-group">
                    <input class="autogen-filter-group-input" jsfc="h:inputText" 
                           value="#{genericMB.crud('entityDummy').searchString}" />
                    <input class="autogen-filter-group-button-search" jsfc="h:commandButton" 
                           value="Buscar" action="#{genericMB.crud('entityDummy').find()}" />
                </div>
            </h:form>
        </ui:define>

        <ui:define name="template.app.content.list">
            <br />
            <h:form>
                <table class="autogen-list-table">
                    <thead class="autogen-list-table-head">
                        <tr class="autogen-list-table-head-row">
                            <th class="autogen-list-table-head-col" scope="col">
                                <input type="checkbox" onclick="checkAll(this);" />
                            </th>
                            <th class="autogen-list-table-head-col" scope="col">#</th>
                            <th class="autogen-list-table-head-col" scope="col">Name</th>
                            <th class="autogen-list-table-head-col" scope="col">Code</th>
                            <th class="autogen-list-table-head-col" scope="col">Fraction</th>
                            <th class="autogen-list-table-head-col" scope="col">Checked</th>
                            <th class="autogen-list-table-head-col" scope="col">Status</th>
                            <th class="autogen-list-table-head-col" scope="col">

                            </th>
                        </tr>
                    </thead>
                    <tbody class="autogen-list-table-body">
                        <ui:repeat value="#{genericMB.crud('entityDummy').entities}" var="lin">
                            <tr class="autogen-list-table-body-row" data-id="#{lin.id}">
                                <td class="autogen-list-table-body-col">
                                    <input data-id="#{lin.id}" type="checkbox" 
                                           onclick="$(this).toggleClass('selected')" />
                                </td>
                                <td class="autogen-list-table-body-col">#{lin.id}</td>
                                <td class="autogen-list-table-body-col">#{lin.name}</td>
                                <td class="autogen-list-table-body-col">#{lin.code}</td>
                                <td class="autogen-list-table-body-col">#{lin.fraction}</td>
                                <td class="autogen-list-table-body-col">#{lin.checked}</td>
                                <td class="autogen-list-table-body-col">#{lin.statusType}</td>
                                <td class="autogen-list-table-body-col" align="right">
                                    <div class="autogen-list-group-button-col" role="group">
                                        <input actionListener="#{genericMB.crud('entityDummy').setEntity(lin)}"
                                               jsfc="h:commandButton" value="Editar" title="Editar"
                                               class="autogen-list-group-button">
                                        </input>
                                        <button id="autogen-list-table-body-col-input-extra-action"
                                                type="button" class="btn btn-outline-secondary" title="Mais" 
                                                data-toggle="dropdown" aria-haspopup="true" 
                                                aria-expanded="false">
                                            <i class="fa fa-ellipsis-v"></i>
                                        </button>
                                        <div class="dropdown-menu" 
                                             aria-labelledby="autogen-list-table-body-col-input-extra-action">
                                            <a class="autogen-list-group-button-extra-button" 
                                               href="/app/delete/entityDummy/#{lin.id}">
                                                <i class="fa fa-search"></i> Ver
                                            </a>
                                            <a class="autogen-list-group-button-extra-button" href="#"
                                               jsfc="h:commandLink" title="Editar"  
                                               actionListener="#{genericMB.crud('entityDummy').setEntity(lin)}" >
                                                <i class="fa fa-pencil"></i> Editar
                                            </a>
                                            <a class="autogen-list-group-button-extra-button" 
                                               href="#" data-toggle="modal" data-target="#autogen-modal"
                                               title="Excluir Modal">
                                                <i class="fa fa-trash"></i> Excluir modal
                                            </a>
                                            <a class="autogen-list-group-button-extra-button" href="#"
                                               jsfc="h:commandLink" title="Excluir JSF"  
                                               actionListener="#{genericMB.crud('entityDummy').remove(lin)}" >
                                                <i class="fa fa-trash"></i> Excluir jsf
                                            </a>
                                            <a onclick="normal_post('/jsf/index.xhtml', {id: '#{lin.id}'});"
                                               class="autogen-list-group-button-extra-button" href="#">
                                                <i class="fa fa-barcode"></i> Ação individual (post)
                                            </a>
                                            <a onclick="$.post('/app/delete/entityDummy/#{lin.id}'); location.reload();" 
                                               class="autogen-list-group-button-extra-button" title="Excluir Rest" href="#">
                                                <i class="fa fa-trash"></i> Excluir rest
                                            </a>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </ui:repeat>
                    </tbody>
                </table>

                <div class="autogen-list-group">
                    <div class="autogen-list-group-button-col" role="group">
                        <button type="button" class="autogen-list-group-button" title="Mais" 
                                data-toggle="dropdown"
                                aria-haspopup="true" 
                                aria-expanded="false" 
                                id="autogen-list-head-extra-action">
                            Selecionados
                            <i class="fa fa-ellipsis-v"></i>
                        </button>
                        <div class="dropdown-menu" 
                             aria-labelledby="autogen-list-head-extra-action">
                            <a class="autogen-list-group-button-extra-button" href="#">
                                <i class="fa fa-search"></i> Excluir
                            </a>
                            <a onclick="normal_post('/jsf/index.xhtml', {ids: table_selected_id(this)});"
                               class="autogen-list-group-button-extra-button" href="#">
                                <i class="fa fa-barcode"></i> Ação 1  (post)
                            </a>
                        </div>
                        <input data-toggle="modal" data-target="#autogen-modal" 
                               value="Ação em lote 2" 
                               title="Ação em lote 2" type="button"
                               class="autogen-list-group-button-raw autogen-button-warn">
                        </input>
                        <input data-toggle="modal" data-target="#autogen-modal" 
                               value="Ação em lote 3" 
                               title="Ação em lote 3" type="button"
                               class="autogen-list-group-button">
                        </input>
                    </div>  

                    <div class="autogen-list-group-pagination-col">
                        <input class="autogen-list-group-pagination-button-prev" jsfc="h:commandButton" value="«"
                               disabled="#{not genericMB.crud('entityDummy').hasPreviousPageQueryResult()}"
                               action="#{genericMB.crud('entityDummy').previousPageQueryResult()}"
                               aria-label="Anterior"/>

                        <!--TODO: ui:repeat begin="" end="" has bug, verify in future -->
                        <c:forEach begin="0" end="#{genericMB.crud('entityDummy').totalPages}" var="idx">
                            <input class="#{genericMB.crud('entityDummy').currentPage eq idx ? 'autogen-list-group-button-page-active':'autogen-list-group-button-page'}" 
                                   jsfc="h:commandButton" action="#{genericMB.crud('entityDummy').paginate(idx)}"
                                   value="#{idx+1}" aria-label="Pagina #{idx}" />
                        </c:forEach>

                        <input class="autogen-list-group-pagination-button-next" jsfc="h:commandButton" value="»"
                               disabled="#{not genericMB.crud('entityDummy').hasNextPageQueryResult()}"
                               action="#{genericMB.crud('entityDummy').nextPageQueryResult()}"
                               aria-label="Proximo"/>
                    </div>
                </div>
            </h:form>
        </ui:define>
    </ui:composition>
</html>